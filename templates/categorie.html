<!DOCTYPE html>
<html lang="fr">
  <head>
    <!-- Informations page (css, script, etc) -->
    {{template "InitPage"}}
    <title>Forum - {{.Category.Name}}</title>
  </head>
  <body>
    <!-- Header -->
    {{template "ForumHeader" .}}

    <!-- Main Content -->
    <main class="main-content">
      <!-- Sidebar -->
      <aside class="sidebar">
        <h3>{{ .Category.Name }}</h3>
        <div>{{.Category.Description}}</div>
      </aside>

      <!-- Posts Section -->
      <section class="posts-section">
        {{ range .Category.Topics }}
          <div class="post-card">
            {{ if gt (len .Messages) 0 }}
              <img class="post-avatar" src="{{(index .Messages 0).Author.ProfilPic}}" />
              <div class="post-content">
                <a class="post-title" href="/topic/{{.TopicID}}">{{.Name}}</a>
                <div class="post-author">
                  Dernier message par
                  <a href="/user/{{(index .Messages .LastPost).Author.ID}}">
                    {{(index .Messages .LastPost).Author.Username}}
                  </a>
                </div>
                <div class="post-text">
                  {{preview (index .Messages .LastPost).Content 300}}
                </div>
              </div>
            {{ else }}
              <div class="post-content">
                <a class="post-title" href="/topic/{{.TopicID}}">{{.Name}}</a>
                <div class="post-text">
                  Aucun message pour l’instant.
                </div>
              </div>
            {{ end }}
          </div>
        {{ else }}
          <div class="post-card">
            <div class="post-content">
              <div class="post-text">
                Cette catégorie ne contient pour l'instant aucun sujet.
              </div>
            </div>
          </div>
        {{ end }}
      </section>
    </main>
  </body>
</html>
